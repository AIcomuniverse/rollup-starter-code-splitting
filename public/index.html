<!doctype html>
<html>
<head lang='en'>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width'>
	<link rel='icon' type='image/png' href='/favicon.png'>

	<title>Rollup code-splitting demo</title>

	<link rel='stylesheet' href='styles.css'>
</head>
<body>
	<h1>Rollup code-splitting demo</h1>

	<p><a href='https://github.com/rollup/rollup-starter-code-splitting'>See the source code on GitHub</a></p>

	<div id='a'>
		<div data-used-by='a'></div>
		<div data-used-by='both'></div>
	</div>

	<div id='b'>
		<div data-used-by='b'></div>
		<div data-used-by='both'></div>
	</div>

	<!-- for modern browsers -->
	<script type='module'>
		import('/module/main-a.js');
		import('/module/main-b.js');
		window.hasDynamicImport = true;
	</script>

	<!-- for older browsers -->
	<script nomodule src='https://unpkg.com/systemjs@0.21.0/dist/system-production.js'></script>
	<script nomodule>
		System.import('nomodule/main-a.js');
		System.import('nomodule/main-b.js');
	</script>

	<!-- this snippet ensures nomodule fallback for browsers supporting modules but not dynamic import -->
	<script type="module">
		if (!window.hasDynamicImport) {
			const noms = Array.prototype.filter.call(document.getElementsByTagName('script'), x => x.hasAttribute('nomodule'));
			function nextLoad (nom, s) {
				if (!(nom = noms.shift())) return;
				s = document.createElement('script');
				if (nom.src)
					s.src = nom.src, s.addEventListener('load', nextLoad), s.addEventListener('error', nextLoad);
				else
					s.innerHTML = nom.innerHTML;
				document.head.appendChild(s);
				if (!nom.src) nextLoad();
			}
			nextLoad();
		}
	</script>
</body>
</html>

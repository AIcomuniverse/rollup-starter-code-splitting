<!doctype html>
<html>
<head lang='en'>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width'>
	<link rel='icon' type='image/png' href='/favicon.png'>

	<title>Rollup code-splitting demo</title>

	<link rel='stylesheet' href='styles.css'>
</head>
<body>
	<h1>Rollup code-splitting demo</h1>

	<p><a href='https://github.com/rollup/rollup-starter-code-splitting'>See the source code on GitHub</a></p>

	<div id='a'>
		<div data-used-by='a'></div>
		<div data-used-by='both'></div>
	</div>

	<div id='b'>
		<div data-used-by='b'></div>
		<div data-used-by='both'></div>
	</div>

    <script nomodule>
	    // If a browser does not support modules, feature detection may not not work properly below, so note this here
		window.loadEntryPoints = null;
    </script>
    <script>
        if (window.loadEntryPoints !== null) {
            try {
                // this will throw a runtime exception in browsers that support "import" but not "import()"
                window.loadEntryPoints = new Function('import("/module/main-a.js");import("/module/main-b.js");');
            } catch (err) {
                window.loadEntryPoints = null;
            }
        }
        if (window.loadEntryPoints) {
            // browser supports dynamic import
            window.loadEntryPoints();
        } else {
            // browser does not support dynamic import
            const systemJsLoaderTag = document.createElement('script');
            systemJsLoaderTag.src = 'https://unpkg.com/systemjs@0.21.4/dist/system-production.js';
            systemJsLoaderTag.addEventListener('load', function () {
                System.import('./nomodule/main-a.js');
                System.import('./nomodule/main-b.js');
            });
            document.head.appendChild(systemJsLoaderTag);
        }
    </script>
</body>
</html>
